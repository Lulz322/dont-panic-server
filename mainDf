FROM debian:11 AS build
RUN apt-get update && apt-get install -y gnupg2 && apt-key adv --keyserver keyserver.debian.com --recv-keys DE19EB17684BA42D
RUN apt-key adv --keyserver keyserver.debian.com --recv-keys 3B4FE6ACC0B21F32
RUN apt-get update && DEBIAN_FRONTEND=noninteractive apt-get install -yq \
        software-properties-common
RUN apt-add-repository 'deb https://apt.kitware.com/debian/ focal main'
RUN apt-get update && DEBIAN_FRONTEND=noninteractive apt-get install -yq \
        vim libmysqlcppconn-dev iputils-ping make wget libssl-dev cmake \
        libpqxx-dev libvpx-dev libx264-dev libavcodec-dev  git yasm \
        libboost-all-dev g++ uuid-dev

## install ffmpeg
RUN git clone https://github.com/SOCI/soci.git soci && cd soci && mkdir build && cd build && cmake .. -DSOCI_CXX11=ON && make install

RUN pwd && ls -la
ENV TZ=Europe/Kiev
RUN ln -snf /usr/share/zoneinfo/$TZ /etc/localtime && echo $TZ > /etc/timezone

WORKDIR /opt/
RUN pwd && ls -la
COPY /libs/ /lib64/
